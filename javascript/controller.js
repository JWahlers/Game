// Main Function
function runController()
{
	var gameBoardMatrix = 	[
								['#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'DR',	'*',	'*',	'*',	'DL',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'#'],
								['#',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#'],
								['#',	'*',	'*',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'#'],
								['#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'DL',	'*',	'#',	'*',	'#'],
								['#',	'*',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'DT',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#'],
								['#',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'DPL',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#'],
								['#',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#'],
								['#',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#'],
								['#',	'*',	'#',	'*',	'#',	'#',	'#',	'DT',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'DB',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#'],
								['#',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'*',	'#'],
								['#',	'DB',	'#',	'DSB',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'DL',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'DSL',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'DR',	'*',	'*',	'*',	'DL',	'*',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'*',	'*',	'#',	'#',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'DR',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'DL',	'*',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'#'],
								['#',	'DT',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'DL',	'*',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'#'],
								['#',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'DB',	'#',	'#',	'#',	'DT',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'*',	'*',	'DL',	'*',	'#',	'*',	'#'],
								['#',	'#',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'#'],
								['#',	'#',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'#'],
								['#',	'#',	'#',	'#',	'#',	'DPB',	'#',	'#',	'#',	'#',	'#',	'DT',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'#',	'#'],
								['#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'#',	'#',	'#',	'*',	'#',	'*',	'#'],
								['#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'*',	'#',	'*',	'#'],
								['#',	'*',	'DSR',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'DSL',	'*',	'#',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'DL',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#'],
								['#',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'*',	'#',	'DST',	'#',	'DT',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#'],
								['#',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'DL',	'*',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#'],
								['#',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'DT',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'#',	'#',	'*',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'*',	'#'],
								['#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'*',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'*',	'#'],
								['#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'*',	'#'],
								['#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'*',	'#'],
								['#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'#',	'*',	'*',	'*',	'#',	'*',	'#'],
								['#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'*',	'#',	'#',	'#',	'*',	'#',	'*',	'#',	'#',	'#',	'*',	'#'],
								['#',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'*',	'#',	'*',	'*',	'*',	'*',	'*',	'#'],
								['#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#',	'#']
							];




	var gameBoardObject = {'matrix':gameBoardMatrix, 'yMax':gameBoardMatrix.length, 'xMax':gameBoardMatrix[0].length};
	var playerObject = {'x':19, 'y':17};


	window.onkeydown = function(e)
	{
	   	var key = e.keyCode ? e.keyCode : e.which;


			// console.log("move up");
	   	if(key == 87 || key == 38)
	   	{
	   		if(playerObject.y > 0 && gameBoardObject.matrix[playerObject.y -1][playerObject.x] != '#') playerObject.y--;
	   	}


			// console.log("move left");
	   	if(key == 65 || key == 37)
	   	{
	   		if(playerObject.x > 0 && gameBoardObject.matrix[playerObject.y][playerObject.x -1] != '#') playerObject.x--;
	   	}



			// console.log("move down");
	   	if(key == 83 || key == 40)
	   	{
	   		if(playerObject.y < gameBoardObject.yMax && gameBoardObject.matrix[playerObject.y +1][playerObject.x] != '#') playerObject.y++;
	   	}



			// console.log("move right");
	   	if(key == 68 || key == 39)
	   	{
	   		if(playerObject.x < gameBoardObject.xMax && gameBoardObject.matrix[playerObject.y][playerObject.x +1] != '#') playerObject.x++;
	   	}


	   buildMap(gameBoardObject);
	}






	function buildMap(gameBoardObject)
	{
		var board = '';
		var fieldOfView = 10;


		for(var y = (playerObject.y-fieldOfView >= 0) ? (playerObject.y-fieldOfView) : (0); y<playerObject.y +fieldOfView && y < gameBoardObject.yMax; y++)
		{
			for(var x = (playerObject.x-(fieldOfView * 2) >= 0) ? (playerObject.x-(fieldOfView * 2)) : (0); x<playerObject.x+(fieldOfView * 2) && x < gameBoardObject.xMax; x++)
			{
				if(x == playerObject.x && y == playerObject.y)
				{
					board += '&Otilde;';
				}
				else
				{
					var boardKey = gameBoardObject.matrix[y][x];

					if(boardKey.includes('D')) board += 'D';
					else board += boardKey;
				}
			}


			board += '<br/>';
		}


		document.getElementById("gameBoard").innerHTML = board;

	}


	buildMap(gameBoardObject);



	function checkHazards()
	{
		if(xLocation == 4 && yLocation == 4)
		{
			currentHitPoints--;

			var deathString = '';

			for(var y=0; y < yMax; y++)
			{
				deathString += 'YOU DIED<br/>';
				alive = false;
			}

			document.getElementById("gameBoard").innerHTML = deathString;
		}
	}
}



// Don't pollute the global (window) namespace! Wrap in a function to essentially create a "private" closure of scope.
(function() {
	function Game() {
		this.stateManager;

		this.init = function() {
			this.stateManager = new StateManager();
		}

		this.run = function() {

		}

		this.checkHazards = function() {

		}
	}

	function StateManager() {
		this.currentLevel = 0;
	}

	function Level() {
		this.matrix = [];
		this.xLength = 10;
		this.yLength = 10;

		this.display = function() {

		}
	}

	function Player() {
		this.health = 3;

	}

	function Door() {
		this.isOpen = false;

		this.open = function() {

		}
	}

	function Wall() {

	}

	function Obstruction() {
		// Abstract for Doors/Walls?
	}

	// Namespace yoself and keep a reference
	window.justin.game = new Game();
})();